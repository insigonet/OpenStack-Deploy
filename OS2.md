---

## **Слайд 1: «Инициализация окружения OpenStack»**
#### **Основные фразы для слайда:**

- Активация виртуального окружения
- Загрузка переменных окружения OpenStack

**Текст презентации:**

Начнём нашу практическую демонстрацию с инициализации окружения. Это необходимо для работы с инструментами командной строки OpenStack.

**Команда для активации виртуального окружения и загрузки переменных окружения:**

```bash
source ~/venv/bin/activate && source ~/admin-openrc.sh
```

*Эта команда активирует виртуальное окружение Python, которое содержит необходимые пакеты для работы с OpenStack CLI, и загружает переменные окружения с учётными данными администратора.*

**Текст после команды:**

Выполнив эту команду, мы подготавливаем нашу среду для взаимодействия с OpenStack через командную строку. Виртуальное окружение позволяет изолировать зависимости, а переменные окружения содержат необходимые креденшалы для аутентификации. Это обеспечивает безопасность и стабильность при работе с OpenStack.

---

**Слайд 2: «Структура системы и расположение файлов»**

**Основные фразы для слайда:**

- Конфигурационные файлы Kolla-Ansible
- Расположение файлов конфигурации и инвентаря
- Структура директорий и логов
- Практические команды для демонстрации

**Текст презентации:**

Давайте рассмотрим, как настроена наша система и где находятся основные файлы. Это важно для понимания структуры системы и последующего обслуживания.

**Команда для отображения содержимого каталога с конфигурационными файлами:**

```bash
sudo ls /etc/kolla
```

*Эта команда показывает содержимое каталога `/etc/kolla`, где хранятся конфигурационные файлы Kolla-Ansible.*

**Текст после команды:**

Мы видим, что в каталоге `/etc/kolla` находятся различные файлы и директории. Здесь расположены конфигурационные файлы для сервисов OpenStack, такие как `globals.yml` и `inventory`.

**Команда для просмотра содержимого файла `globals.yml`:**

```bash
cat /etc/kolla/globals.yml
```

*Эта команда выводит на экран содержимое основного файла конфигурации Kolla-Ansible.*

**Текст после команды:**

В файле `globals.yml` содержатся глобальные настройки нашей OpenStack установки. Здесь мы можем увидеть параметры, такие как:

- `kolla_base_distro`: базовый дистрибутив (Ubuntu)
- `openstack_release`: версия OpenStack (2023.2)
- Настройки сетевых интерфейсов и VIP-адресов
- Включенные и отключенные сервисы

**Команда для просмотра инвентарного файла:**

```bash
cat /etc/kolla/inventory
```

*Эта команда показывает содержимое файла `inventory`, который используется Ansible для определения узлов и их ролей.*

**Текст после команды:**

В инвентарном файле перечислены все узлы нашей OpenStack установки и указаны их роли. Поскольку мы используем all-in-one установку, здесь указан только один узел.

**Команда для просмотра структуры логов OpenStack:**

```bash
sudo ls /var/log/kolla
```

*Эта команда отображает каталоги с логами различных сервисов OpenStack.*

**Текст после команды:**

Логи сервисов хранятся в `/var/log/kolla`. Здесь мы можем найти логи для `nova`, `neutron`, `glance` и других сервисов. Это полезно для диагностики и мониторинга работы системы.

---

**Слайд 3: «Диагностика текущих сервисов OpenStack»**

**Основные фразы для слайда:**

- Проверка состояния сервисов OpenStack
- Анализ запущенных контейнеров
- Практические примеры диагностики

**Текст презентации:**

Регулярная диагностика состояния сервисов помогает поддерживать стабильную работу системы и быстро обнаруживать возможные проблемы.

**Команда для отображения списка запущенных контейнеров:**

```bash
docker ps -a
```

*Эта команда показывает все Docker-контейнеры, их статус и связанные образы.*

**Текст после команды:**

В выводе команды мы видим список всех контейнеров OpenStack, запущенных Kolla-Ansible. Например:

- `nova_compute` — отвечает за запуск виртуальных машин
- `neutron_server` — управляет сетевыми функциями
- `glance_api` — предоставляет доступ к образам виртуальных машин

**Команда для проверки состояния агентов Neutron:**

```bash
openstack network agent list
```

*Эта команда показывает состояние агентов Neutron, таких как DHCP, L3, Metadata и Open vSwitch агент.*

**Текст после команды:**

Мы видим, что все агенты Neutron находятся в состоянии "UP" и работают корректно. Это важно для обеспечения сетевой функциональности виртуальных машин.

**Команда для вывода всех сервисов OpenStack:**

```bash
openstack service list
```

*Эта команда отображает список всех сервисов OpenStack и их состояние.*

**Текст после команды:**

Вывод команды показывает все зарегистрированные сервисы OpenStack, такие как `nova`, `neutron`, `glance`, `keystone` и другие. Мы можем убедиться, что все необходимые сервисы запущены и функционируют правильно.

**Дополнительная диагностика:**

**Команда для проверки состояния гипервизоров:**

```bash
openstack hypervisor list
```

*Эта команда отображает список гипервизоров и их состояние.*

**Текст после команды:**

Вывод команды подтверждает, что наш гипервизор активен и готов к запуску виртуальных машин.

---

**Слайд 4: «Пример изменения конфигурации OpenStack»**

**Основные фразы для слайда:**

- Обновление конфигурации с помощью Kolla-Ansible
- Пример изменения параметра debug для Nova
- Обновление контейнеров до новой конфигурации

**Текст презентации:**

Иногда возникает необходимость внести изменения в конфигурацию OpenStack. Покажем это на примере изменения уровня логирования для сервиса Nova.

**Шаг 1: Изменение конфигурационного файла**

```bash
sudo nano /etc/kolla/nova/nova.conf
```

*Мы открываем конфигурационный файл Nova для редактирования.*

**Текст после действия:**

В файле `nova.conf` мы находим параметр `debug` и устанавливаем его значение на `true`:

```ini
[DEFAULT]
debug = true
```

**Что дает нам это изменение?**

Установка `debug = true` увеличивает подробность логирования для сервиса Nova. Это полезно для диагностики и отладки, так как позволяет получать более детальную информацию о работе сервиса. Однако стоит учитывать, что это может увеличить объем логов и потенциально повлиять на производительность, поэтому рекомендуется использовать данный режим временно, только для целей диагностики.

**Шаг 2: Применение изменений и перезапуск сервисов**

```bash
kolla-ansible -i /etc/kolla/inventory reconfigure -t nova
```

*Флаг `-t nova` указывает, что мы хотим применить изменения только для сервиса Nova.*

**Текст после команды:**

Kolla-Ansible применит изменения конфигурации для сервиса Nova и перезапустит соответствующие контейнеры. Это происходит без простоя других сервисов, обеспечивая непрерывность работы системы.

---

**Слайд 5: «Мониторинг и логирование в OpenStack»**

**Основные фразы для слайда:**

- Использование логов для диагностики
- Мониторинг сервисов через командную строку
- Практические примеры мониторинга

**Текст презентации:**

Эффективный мониторинг и анализ логов являются ключевыми для поддержания стабильной работы OpenStack и быстрого решения проблем.

**Просмотр логов сервисов:**

Логи сервисов хранятся в `/var/log/kolla/<service_name>`.

**Пример: Просмотр логов сервиса Nova**

```bash
sudo tail -f /var/log/kolla/nova/nova-compute.log
```

*Эта команда позволяет в режиме реального времени наблюдать за логами сервиса `nova-compute`.*

**Текст после команды:**

Наблюдая за логами, мы можем выявлять ошибки, предупреждения и другие важные сообщения, которые помогут в диагностике проблем.

**Мониторинг состояния сервисов с помощью команд OpenStack:**

**Команда для мониторинга использования ресурсов гипервизора:**

```bash
openstack hypervisor stats show
```

*Команда выводит статистику использования ресурсов, таких как количество ядер CPU, объем памяти и дискового пространства.*

**Текст после команды:**

Мы получаем актуальную информацию о загрузке нашего гипервизора, что позволяет принимать решения о распределении нагрузок и необходимости масштабирования.

**Использование команд для проверки состояния виртуальных машин:**

```bash
openstack server list --long
```

*Команда выводит расширенную информацию о виртуальных машинах, включая статус, uptime и использованные ресурсы.*

**Текст после команды:**

Это помогает отслеживать состояние виртуальных машин, выявлять зависшие или некорректно работающие инстансы.

---

**Слайд 6: «Загрузка нового образа в Glance»**

**Основные фразы для слайда:**

- Добавление образа Ubuntu 24.04v2 в Glance
- Проверка доступных образов
- Практический пример

**Текст презентации:**

Загрузим новый образ операционной системы в сервис Glance для использования при создании виртуальных машин.

**Команда для загрузки образа в Glance:**

```bash
openstack image create --disk-format qcow2 --container-format bare --file noble-server-cloudimg-amd64.img Ubuntu-24.04v2
```

**Текст после команды:**

Новый образ `Ubuntu-24.04v2` успешно загружен и доступен для использования.

**Команда для проверки списка доступных образов:**

```bash
openstack image list
```

**Текст после команды:**

Мы видим обновленный список образов, включая только что загруженный образ. Теперь мы можем использовать его при создании новых виртуальных машин.

---

**Слайд 7: «Просмотр сетей и групп безопасности»**

**Основные фразы для слайда:**

- Проверка доступных сетей
- Просмотр групп безопасности
- Вывод правил группы безопасности

**Текст презентации:**

Давайте посмотрим, какие сети и группы безопасности доступны в нашей системе.

**Команда для просмотра сетей:**

```bash
openstack network list
```

**Текст после команды:**

Команда показывает список сетей, доступных в OpenStack. Например, сеть `external_network`.

**Команда для просмотра групп безопасности:**

```bash
openstack security group list
```

**Текст после команды:**

Мы видим список групп безопасности, включая группу с ID `7c4afa9a-ec8f-478e-ae4f-67b2195d5180`, которую будем использовать при создании виртуальной машины.

**Команда для вывода правил группы безопасности:**

```bash
openstack security group rule list 7c4afa9a-ec8f-478e-ae4f-67b2195d5180
```

**Текст после команды:**

Команда отображает все правила, связанные с данной группой безопасности. Мы можем увидеть разрешенные входящие и исходящие порты, протоколы и направления трафика. Это важно для обеспечения необходимого уровня доступа к виртуальным машинам и безопасности сети.

---

**Слайд 8: «Интеграция с HostBill»**

**Основные фразы для слайда:**

- Создание виртуальной машины из HostBill
- Управление виртуальными машинами HostBill через CLI
- Практические команды для диагностики

**Текст презентации:**

Наш OpenStack интегрирован с системой биллинга HostBill, что позволяет автоматизировать процесс создания виртуальных машин для пользователей.

**Создание виртуальной машины из HostBill:**

Сейчас я продемонстрирую создание виртуальной машины из панели HostBill. После создания мы сможем управлять этой VM через OpenStack CLI.

**(Во время презентации вы заходите в HostBill и создаете VM из кабинета пользователя.)**

**Текст после действия:**

После создания виртуальной машины из HostBill мы можем увидеть её в списке виртуальных машин и управлять ею так же, как и любыми другими VM.

---

**Слайд 9: «Управление виртуальными машинами и пользователями»**

**Основные фразы для слайда:**

- Вывод всех пользователей
- Определение владельцев виртуальных машин
- Практические команды для администрирования

**Текст презентации:**

Важно знать, какие виртуальные машины принадлежат каким пользователям, особенно при интеграции с системами биллинга.

**Команда для вывода списка всех пользователей:**

```bash
openstack user list
```

**Текст после команды:**

Мы получаем список всех пользователей, зарегистрированных в OpenStack.

**Пример: Вывод виртуальных машин пользователя `hb_client_51_1`:**

**Шаг 1: Получение ID пользователя `hb_client_51_1`:**

```bash
openstack user list | grep hb_client_51_1
```

*Команда выводит информацию о пользователе с именем `hb_client_51_1`.*

**Текст после команды:**

Мы получаем строку с информацией о пользователе, включая его ID.

**Шаг 2: Вывод виртуальных машин пользователя:**

```bash
openstack server list --all-projects --user <USER_ID>
```

*Замените `<USER_ID>` на полученный ID пользователя `hb_client_51_1`.*

**Текст после команды:**

Команда показывает все виртуальные машины, принадлежащие пользователю `hb_client_51_1`, включая только что созданную из HostBill. Это полезно для мониторинга и управления ресурсами конкретного клиента.

---

**Слайд 10: «Планы на будущее и заключение»**

**Основные фразы для слайда:**

- Расширение кластера с добавлением новых узлов и сервисов
- Балансировка нагрузки и высокая доступность
- Бэкап и восстановление
- Заключение

**Текст презентации:**

В будущем мы планируем расширить наш OpenStack кластер и добавить новые возможности.

**Темы для следующей презентации:**

- **Добавление нового вычислительного узла и сервисов:**

  Мы рассмотрим процесс добавления нового узла `w1-node-02` в кластер, включая подготовку сервера, настройку инвентаря и развертывание дополнительных сервисов на новом узле.

- **Создание внутренних сетей и роутеров:**

  Настроим внутренние сети для виртуальных машин и обеспечим маршрутизацию между ними и внешней сетью.

- **Балансировка нагрузки и высокая доступность:**

  Обсудим, как настроить балансировку нагрузки между сервисами и обеспечить отказоустойчивость нашей инфраструктуры.

- **Бэкап и восстановление:**

  Рассмотрим стратегии резервного копирования данных и восстановления системы в случае сбоев.

**Заключение:**

Спасибо за внимание! Сегодня мы рассмотрели практические аспекты работы с OpenStack, включая инициализацию окружения, диагностику сервисов, мониторинг, изменение конфигурации, управление виртуальными машинами и интеграцию с HostBill. В следующей презентации мы углубимся в более сложные темы и продемонстрируем их на практике.

---

**Что еще можно добавить в презентацию:**

- **Безопасность и управление доступом:**

  Рассмотреть методы обеспечения безопасности в OpenStack, включая управление ролями и правами пользователей.

- **Автоматизация и оркестрация:**

  Показать, как использовать инструменты автоматизации для развертывания и управления ресурсами, например, с помощью Heat или Terraform.

- **Интеграция с внешними сервисами:**

  Рассмотреть возможности интеграции OpenStack с другими облачными сервисами или системами хранения данных.

- **Оптимизация производительности:**

  Предложить методы оптимизации настроек OpenStack для повышения производительности и эффективности использования ресурсов.

---
